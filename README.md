# virus_encapsulin_2025

This repository contains the code and analyses associated with the article:

**“Small viruses reveal multiple evolutionary transitions between HK97-fold viruses and encapsulins”**  
*(currently under revision)*

It is also linked to the bioRxiv preprint:  
[**“Small uncultured viral-like entities redraw the origin of viruses and cellular compartments”**](https://www.biorxiv.org/content/10.1101/2025.06.18.659913v1)

---

## Background

The **HK97-fold** is a conserved protein structure that forms the building block of viral capsids in the realm *Duplodnaviria* and encapsulin compartments in prokaryotes.  
While it has been proposed that encapsulins evolved from HK97-fold viruses, this idea is difficult to reconcile with the larger and more complex nature of viral capsids.

In this project we searched metagenomic data for **small HK97-fold viral entities**. These genomes show strong molecular similarities to encapsulins, lack tail genes, and provide evidence for **multiple evolutionary transitions** between encapsulins and HK97-fold viruses. Structural and phylogenetic analyses suggest that **viral procapsids** may represent an ancestral form bridging both lineages.

---

## About this repository

The repository is organized to follow the flow of the analyses described in the manuscript.  
It contains code and outputs covering the main steps of the study: from data description and protein domain annotation, to phylogenetic reconstruction, and structural analyses of HK97-fold proteins. Scripts used to generate both main and supplementary figures and tables are also included.

---

